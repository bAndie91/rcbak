.\" Automatically generated by Pod::Man 2.25 (Pod::Simple 3.16)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "rcbak 1"
.TH rcbak 1 "2016-12-09" "0.6" "RunCommand Backup"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
rcbak \- Incremental backup mechanism based on tar,
configured by dotfiles and supporting gpg\-encryption
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Navigate to a directory containing required \fI.rcbak.*\fR files, 
then call \fIrcbak\fR\|(1).
First time the programm generates an initial \fItar\fR\|(1) archive
and a meta-file named \fIincrement.snar\fR.
Subsequent run of \fIrcbak\fR\|(1) makes a timestamped archive file: \fIYYYY\-mm\-dd_HHMM.tar.gz\fR.
If you already have archives, but want to do a full backup as initially,
just rename \fIincrement.snar\fR.
A list of files to be archived is also generated, 
it is in \s-1NTS\s0 format (null terminated strings of file paths relative to base directory), \fIYYYY\-mm\-dd_HHMM.nts\fR.
It gives the chance to restore only those files from the incremental archives, 
which were exist on the given time,
not the deleted ones. 
File listing preceeds creating the archive, 
so \s-1NTS\s0 list and archived files may be inconsistent,
depending on usage of files and folders.
However even \fItar\fR\|(1) itself is not atomic.
Consider using filesystem snapshots.
On every incremental backup it saves \fIincrement.snar\fR to \fIincrement.snar.old\fR,
so you can rollback manually to the previous state after a failed backup process.
.SH "EXAMPLE"
.IX Header "EXAMPLE"
.Vb 3
\& cd backups/personal
\& echo \*(Aq$HOME/documents\*(Aq > .rcbak.ba
\& rcbak
.Ve
.SH "FILES"
.IX Header "FILES"
.SS "\fI.rcbak.ba\fP (required)"
.IX Subsection ".rcbak.ba (required)"
Contains base directory of files and folders to be archived. May contain environments (eg. \fB\f(CB$HOME\fB\fR) and output-substitution (\fB$(...)\fR).
.SS "\fI.rcbak.ls\fP"
.IX Subsection ".rcbak.ls"
List of files (separated by newline) within the base directory to be archived. Default is the whole folder, if \fI.rcbak.ls\fR is missing.
.SS "\fI.rcbak.ex\fP"
.IX Subsection ".rcbak.ex"
List of files and patterns (separated by newline) to be excluded from the archive. Patterns are recognized by \fItar\fR\|(1), see option \f(CW\*(C`\-\-exclude\*(C'\fR.
.SS "\fI.rcbak.ar\fP"
.IX Subsection ".rcbak.ar"
Archiver compressor name. One of these: \fIcompress\fR\|(1), \fIgzip\fR\|(1), \fIbzip2\fR\|(1), \fIxz\fR\|(1).
.SS "\fI.noBackup\fP, \fI.rcbak.no\fP"
.IX Subsection ".noBackup, .rcbak.no"
Skip entire directory containing such a file. See \fItar\fR\|(1) option \f(CW\*(C`\-\-exclude\-tag\*(C'\fR.
.SS "\fI.rcbak.su\fP"
.IX Subsection ".rcbak.su"
Contains a username in 1st line. Programm reads files in name of this user using \fIsudo\fR\|(1). Write operations are not done by this user, so archive file created by the user started rcbak.
.SS "\fI.rcbak.to\fP"
.IX Subsection ".rcbak.to"
Encrypt resulting archive for the named \s-1GPG\s0 user and signed by the default \s-1GPG\s0 key. See \fIgpg\fR\|(1) option \f(CW\*(C`\-\-recipient\*(C'\fR.
.SS "\fI.rcbak.pr\fP"
.IX Subsection ".rcbak.pr"
Post-run script. Includes this file in the main namespace of \fIrcbak\fR\|(1) and executes it, if exists.
.SS "\fI.rcbak.lk\fP"
.IX Subsection ".rcbak.lk"
Lock file.
.SS "\fIincrement.snar\fP"
.IX Subsection "increment.snar"
Meta file of incremented backup. See \fItar\fR\|(1) option \f(CW\*(C`\-\-listed\-incremental\*(C'\fR.
.SS "\fIincrement.snar.old\fP"
.IX Subsection "increment.snar.old"
A copy of \fIincrement.snar\fR made before overwritten. This makes user able to restore the previous state of backup archives, if something goes wrong.
